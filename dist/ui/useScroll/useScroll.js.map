{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/ui/useScroll/useScroll.ts"],"sourcesContent":["import { RefObject, useEffect, useRef } from \"react\";\n\nimport { isNumber, isDom } from \"@m78/utils\";\nimport _clamp from \"lodash/clamp\";\nimport { getRefDomOrDom, useSelf, useThrottle } from \"@m78/hooks\";\nimport { useSpring, config } from \"react-spring\";\n\ninterface UseScrollOptions {\n  /** 指定滚动元素或ref，el、el.current、ref.current取值，只要有任意一个为dom元素则返回, 默认的滚动元素是documentElement */\n  el?: HTMLElement | RefObject<any>;\n  /** 滚动时触发 */\n  onScroll?(meta: UseScrollMeta): void;\n  /** 100 | 配置了onScroll时，设置throttle时间, 单位(ms) */\n  throttleTime?: number;\n  /** 0 | 滚动偏移值, 使用scrollToElement时，会根据此值进行修正 */\n  offset?: number;\n  /** y轴的偏移距离，优先级高于offset */\n  offsetX?: number;\n  /** x轴的偏移距离，优先级高于offset */\n  offsetY?: number;\n  /** 0 | touch系列属性的触发修正值 */\n  touchOffset?: number;\n}\n\nexport interface UseScrollSetArg {\n  /** 指定滚动的x轴 */\n  x?: number;\n  /** 指定滚动的y轴 */\n  y?: number;\n  /** 以当前滚动位置为基础进行增减滚动 */\n  raise?: boolean;\n  /** 为true时阻止动画 */\n  immediate?: boolean;\n}\n\nexport interface UseScrollMeta {\n  /** 滚动元素 */\n  el: HTMLElement;\n  /** x轴位置 */\n  x: number;\n  /** y轴位置 */\n  y: number;\n  /** 可接受的x轴滚动最大值(值大于0说明可滚动， 但不能保证开启了滚动) */\n  xMax: number;\n  /** 可接受的y轴滚动最大值(值大于0说明可滚动， 但不能保证开启了滚动) */\n  yMax: number;\n  /** 元素高度 */\n  height: number;\n  /** 元素宽度 */\n  width: number;\n  /** 元素实际高度(包含边框/滚动条/内边距等) */\n  offsetWidth: number;\n  /** 元素实际宽度(包含边框/滚动条/内边距等) */\n  offsetHeight: number;\n  /** 元素总高度 */\n  scrollHeight: number;\n  /** 元素总宽度 */\n  scrollWidth: number;\n  /** 滚动条位于最底部 */\n  touchBottom: boolean;\n  /** 滚动条位于最右侧 */\n  touchRight: boolean;\n  /** 滚动条位于最顶部 */\n  touchTop: boolean;\n  /** 滚动条位于最左侧 */\n  touchLeft: boolean;\n}\n\ninterface UseScrollPosBase {\n  x?: number;\n  y?: number;\n}\n\nexport function useScroll<ElType extends HTMLElement>(\n  {\n    el,\n    onScroll,\n    throttleTime = 100,\n    offset = 0,\n    offsetX,\n    offsetY,\n    touchOffset = 0,\n  } = {} as UseScrollOptions\n) {\n  // 用于返回的节点获取ref\n  const ref = useRef<ElType>(null);\n\n  // 获取documentElement和body, 放到useEffect以兼容SSR\n  const self = useSelf({\n    docEl: null! as HTMLElement,\n    bodyEl: null! as HTMLElement,\n  });\n\n  const [spValue, spApi] = useSpring<{ y: number; x: number }>(() => ({\n    y: 0,\n    x: 0,\n    config: { clamp: true, ...config.stiff },\n  }));\n\n  /** 滚动处理 */\n  const scrollHandle = useThrottle(() => {\n    onScroll && onScroll(get());\n  }, throttleTime);\n\n  /** 初始化获取根节点 */\n  useEffect(() => {\n    self.docEl = document.documentElement;\n    self.bodyEl = document.body;\n  }, []);\n\n  /** 绑定滚动事件 */\n  useEffect(() => {\n    const sEl = getEl();\n\n    /* 坑: 页面级滚动scroll事件绑在documentElement和body上无效, 只能绑在window上 */\n    const scrollEl = elIsDoc(sEl) ? window : sEl;\n\n    scrollEl.addEventListener(\"scroll\", scrollHandle);\n\n    return () => {\n      scrollEl.removeEventListener(\"scroll\", scrollHandle);\n    };\n  }, [el, ref.current]);\n\n  /** 执行滚动、拖动操作时，停止当前正在进行的滚动操作 */\n  useEffect(() => {\n    const sEl = getEl();\n\n    function wheelHandle() {\n      if (spValue.x.isAnimating || spValue.y.isAnimating) {\n        // @ts-ignore\n        spApi.stop();\n      }\n    }\n\n    sEl.addEventListener(\"wheel\", wheelHandle);\n    sEl.addEventListener(\"touchmove\", wheelHandle);\n\n    return () => {\n      sEl.removeEventListener(\"wheel\", wheelHandle);\n      sEl.removeEventListener(\"touchmove\", wheelHandle);\n    };\n  }, [el, ref.current]);\n\n  /** 检测元素是否是body或html节点 */\n  function elIsDoc(_el?: HTMLElement) {\n    const sEl = _el || getEl();\n    return sEl === self.docEl || sEl === self.bodyEl;\n  }\n\n  /** 根据参数获取滚动元素，默认为文档元素 */\n  function getEl(): HTMLElement {\n    return getRefDomOrDom(el, ref) || self.docEl;\n  }\n\n  /** 动画滚动到指定位置 */\n  function animateTo(\n    sEl: HTMLElement,\n    next: UseScrollPosBase,\n    now: UseScrollPosBase\n  ) {\n    const isDoc = elIsDoc(sEl);\n\n    spApi({\n      ...next,\n      from: now,\n      onChange(result: any) {\n        const x = result.value.x;\n        const y = result.value.y;\n\n        if (isDoc) {\n          setDocPos(x, y);\n        } else {\n          sEl.scrollTop = y;\n          sEl.scrollLeft = x;\n        }\n      },\n    });\n  }\n\n  /** 根据传入的x、y值设置滚动位置 */\n  function set({ x, y, raise, immediate }: UseScrollSetArg) {\n    const scroller = getEl();\n\n    const { xMax, yMax, x: oldX, y: oldY } = get();\n\n    const nextPos: UseScrollPosBase = {};\n    const nowPos: UseScrollPosBase = {\n      x: oldX,\n      y: oldY,\n    };\n\n    if (isNumber(x)) {\n      let nextX = x;\n\n      if (raise) {\n        nextX = _clamp(oldX + x, 0, xMax);\n      }\n\n      if (nextX !== oldX) {\n        nextPos.x = nextX;\n      }\n    }\n\n    if (isNumber(y)) {\n      let nextY = y;\n\n      if (raise) {\n        nextY = _clamp(oldY + y, 0, yMax);\n      }\n\n      if (nextY !== oldY) {\n        nextPos.y = nextY;\n      }\n    }\n\n    if (\"x\" in nextPos || \"y\" in nextPos) {\n      const isDoc = elIsDoc(scroller);\n\n      if (immediate) {\n        if (isNumber(nextPos.x)) {\n          if (isDoc) {\n            setDocPos(nextPos.x);\n          } else {\n            scroller.scrollLeft = nextPos.x;\n          }\n        }\n        if (isNumber(nextPos.y)) {\n          if (isDoc) {\n            setDocPos(undefined, nextPos.y);\n          } else {\n            scroller.scrollTop = nextPos.y;\n          }\n        }\n      } else {\n        animateTo(scroller, nextPos, nowPos);\n      }\n    }\n  }\n\n  /**\n   * 传入选择器或者dom元素\n   * @param selector | target\n   *    selector - 滚动到以该选择器命中的第一个元素\n   *    element - 滚动到指定元素\n   * @param immediate - 是否跳过动画\n   * */\n  function scrollToElement(selector: string, immediate?: boolean): void;\n  function scrollToElement(element: HTMLElement, immediate?: boolean): void;\n  function scrollToElement(arg: string | HTMLElement, immediate?: boolean) {\n    const sEl = getEl();\n    const isDoc = elIsDoc(sEl);\n\n    let targetEl: HTMLElement | null;\n\n    if (!sEl.getBoundingClientRect) {\n      console.warn(\"The browser does not support `getBoundingClientRect` API\");\n      return;\n    }\n\n    if (typeof arg === \"string\") {\n      targetEl = getEl().querySelector(arg);\n    } else {\n      targetEl = arg;\n    }\n\n    if (!isDom(targetEl)) return;\n\n    const { top: cTop, left: cLeft } = targetEl.getBoundingClientRect();\n    const { top: fTop, left: fLeft } = sEl.getBoundingClientRect();\n\n    /**\n     * 使用offsetTop等属性只能获取到元素相对于第一个非常规定位父元素的距离，所以需要单独计算\n     * 计算规则: eg. 子元素距离顶部比父元素多100px，滚动条位置应该减少100px让两者等值\n     * */\n    const xOffset = offsetX || offset;\n    const yOffset = offsetY || offset;\n\n    set({\n      x: cLeft - fLeft + xOffset,\n      y: cTop - fTop + yOffset,\n      raise: !isDoc, // 如果滚动节点为html元素, 可以直接取计算结果\n      immediate,\n    });\n  }\n\n  /** 获取各种有用的滚动信息 */\n  function get(): UseScrollMeta {\n    const isDoc = elIsDoc();\n\n    const sEl = getEl();\n\n    let x = isDoc\n      ? self.docEl.scrollLeft + self.bodyEl.scrollLeft\n      : sEl.scrollLeft;\n    let y = isDoc\n      ? self.docEl.scrollTop + self.bodyEl.scrollTop\n      : sEl.scrollTop;\n\n    /* chrome高分屏+缩放时，滚动值会是小数，想上取整防止计算错误 */\n    x = Math.ceil(x);\n    y = Math.ceil(y);\n\n    const height = sEl.clientHeight;\n    const width = sEl.clientWidth;\n    const { scrollHeight } = sEl;\n    const { scrollWidth } = sEl;\n\n    /* chrome下(高分屏+缩放),无滚动的情况下scrollWidth会大于width */\n    const xMax = Math.max(0, scrollWidth - width);\n    const yMax = Math.max(0, scrollHeight - height);\n\n    return {\n      el: sEl,\n      x,\n      y,\n      xMax,\n      yMax,\n      height,\n      width,\n      scrollHeight,\n      scrollWidth,\n      touchBottom: yMax - y - touchOffset <= 0,\n      touchLeft: x <= touchOffset,\n      touchRight: xMax - x - touchOffset <= 0, // 总宽度 - 宽度 = 滚动条实际宽度\n      touchTop: y <= touchOffset,\n      offsetWidth: sEl.offsetWidth,\n      offsetHeight: sEl.offsetHeight,\n    };\n  }\n\n  /** 设置根级的滚动位置 */\n  function setDocPos(x?: number, y?: number) {\n    if (isNumber(x)) {\n      // 只有一个会生效\n      self.bodyEl.scrollLeft = x;\n      self.docEl.scrollLeft = x;\n    }\n\n    if (isNumber(y)) {\n      self.bodyEl.scrollTop = y;\n      self.docEl.scrollTop = y;\n    }\n  }\n\n  return {\n    set,\n    get,\n    scrollToElement,\n    ref,\n  };\n}\n"],"names":["useEffect","useRef","isNumber","isDom","_clamp","getRefDomOrDom","useSelf","useThrottle","useSpring","config","useScroll","el","onScroll","throttleTime","offset","offsetX","offsetY","touchOffset","elIsDoc","_el","sEl","getEl","self","docEl","bodyEl","ref","animateTo","next","now","isDoc","spApi","from","onChange","result","x","value","y","setDocPos","scrollTop","scrollLeft","set","raise","immediate","scroller","get","xMax","yMax","oldX","oldY","nextPos","nowPos","nextX","nextY","undefined","scrollToElement","arg","targetEl","getBoundingClientRect","console","warn","querySelector","top","cTop","left","cLeft","fTop","fLeft","xOffset","yOffset","Math","ceil","height","clientHeight","width","clientWidth","scrollHeight","scrollWidth","max","touchBottom","touchLeft","touchRight","touchTop","offsetWidth","offsetHeight","clamp","stiff","spValue","scrollHandle","document","documentElement","body","scrollEl","window","addEventListener","removeEventListener","current","wheelHandle","isAnimating","stop"],"mappings":"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"}