{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/effect/useDebounce/useDebounce.ts"],"sourcesContent":["import { useEffect } from \"react\";\nimport { AnyFunction, __GLOBAL__ } from \"@m78/utils\";\nimport { useSelf, useFn } from \"@m78/hooks\";\n\n/**\n * 传入一个函数，经过防抖处理后返回, 返回函数的内存地址会一直保持不变\n * @param fn - 待防抖的函数\n * @param wait - 防抖延迟时间\n * @returns debounceFn - 经过防抖处理后的函数\n * @returns debounceFn.cancel() - 取消防抖调用\n */\nexport function useDebounce<T extends AnyFunction>(fn: T, wait = 300) {\n  const self = useSelf({\n    timer: undefined as any,\n  });\n\n  const cancel = useFn(() => {\n    if (self.timer) {\n      __GLOBAL__.clearTimeout(self.timer);\n    }\n  });\n\n  useEffect(() => {\n    return cancel;\n  });\n\n  const memoFn = useFn((...args) => {\n    cancel();\n\n    self.timer = __GLOBAL__.setTimeout(() => {\n      fn(...args);\n      __GLOBAL__.clearTimeout(self.timer);\n    }, wait);\n  });\n\n  const bundle = Object.assign(memoFn as T, {\n    cancel,\n  });\n\n  return bundle;\n}\n"],"names":["useEffect","__GLOBAL__","useSelf","useFn","useDebounce","fn","wait","self","timer","undefined","cancel","clearTimeout","memoFn","args","setTimeout","bundle","Object","assign"],"mappings":"AAAA;AAAA,SAASA,SAAS,QAAQ,OAAO,CAAC;AAClC,SAAsBC,UAAU,QAAQ,YAAY,CAAC;AACrD,SAASC,OAAO,EAAEC,KAAK,QAAQ,YAAY,CAAC;AAE5C;;;;;;CAMC,GACD,OAAO,SAASC,WAAW,CAAwBC,EAAK,EAAc;QAAZC,IAAI,GAAJA,+CAAU,kBAAH,GAAG;IAClE,IAAMC,IAAI,GAAGL,OAAO,CAAC;QACnBM,KAAK,EAAEC,SAAS;KACjB,CAAC,AAAC;IAEH,IAAMC,MAAM,GAAGP,KAAK,CAAC,WAAM;QACzB,IAAII,IAAI,CAACC,KAAK,EAAE;YACdP,UAAU,CAACU,YAAY,CAACJ,IAAI,CAACC,KAAK,CAAC,CAAC;QACtC,CAAC;IACH,CAAC,CAAC,AAAC;IAEHR,SAAS,CAAC,WAAM;QACd,OAAOU,MAAM,CAAC;IAChB,CAAC,CAAC,CAAC;IAEH,IAAME,MAAM,GAAGT,KAAK,CAAC,WAAa;yCAATU,IAAI;YAAJA,IAAI;;QAC3BH,MAAM,EAAE,CAAC;QAETH,IAAI,CAACC,KAAK,GAAGP,UAAU,CAACa,UAAU,CAAC,WAAM;YACvCT,EAAE,CAAFA,KAAW,CAAXA,KAAAA,CAAE,EAAC,qBAAGQ,IAAI,CAAJA,CAAK,CAAC;YACZZ,UAAU,CAACU,YAAY,CAACJ,IAAI,CAACC,KAAK,CAAC,CAAC;QACtC,CAAC,EAAEF,IAAI,CAAC,CAAC;IACX,CAAC,CAAC,AAAC;IAEH,IAAMS,MAAM,GAAGC,MAAM,CAACC,MAAM,CAACL,MAAM,EAAO;QACxCF,MAAM,EAANA,MAAM;KACP,CAAC,AAAC;IAEH,OAAOK,MAAM,CAAC;AAChB,CAAC"}