{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/effect/useEvent/useEvent.ts"],"sourcesContent":["import { useFn } from \"@m78/hooks\";\nimport { useEffect } from \"react\";\nimport { AnyFunction, CustomEvent, createEvent as create } from \"@m78/utils\";\n\nexport interface CustomEventWithHook<Listener extends AnyFunction>\n  extends CustomEvent<Listener> {\n  useEvent(listener: Listener): void;\n}\n\n/** 增强一个现有事件对象 */\nexport function enhance<Listener extends AnyFunction = AnyFunction>(\n  event: CustomEvent<Listener>\n): CustomEventWithHook<Listener> {\n  const useEvent = (listener: Listener) => {\n    const memoHandle = useFn(listener);\n\n    useEffect(() => {\n      event.on(memoHandle);\n\n      return () => event.off(memoHandle);\n    }, []);\n  };\n\n  return Object.assign(event, {\n    useEvent,\n  });\n}\n\n/**\n * 自定义事件，用于多个组件间或组件外进行通讯\n * */\nfunction createEvent<Listener extends AnyFunction = AnyFunction>() {\n  return enhance<Listener>(create<Listener>());\n}\n\ncreateEvent.enhance = enhance;\n\nexport { createEvent };\n"],"names":["useFn","useEffect","createEvent","create","enhance","event","useEvent","listener","memoHandle","on","off","Object","assign"],"mappings":"AAAA,SAASA,KAAK,QAAQ,YAAY,CAAC;AACnC,SAASC,SAAS,QAAQ,OAAO,CAAC;AAClC,SAAmCC,WAAW,IAAIC,MAAM,QAAQ,YAAY,CAAC;AAO7E,eAAe,GACf,OAAO,SAASC,OAAO,CACrBC,KAA4B,EACG;IAC/B,IAAMC,QAAQ,GAAG,SAACC,QAAkB,EAAK;QACvC,IAAMC,UAAU,GAAGR,KAAK,CAACO,QAAQ,CAAC,AAAC;QAEnCN,SAAS,CAAC,WAAM;YACdI,KAAK,CAACI,EAAE,CAACD,UAAU,CAAC,CAAC;YAErB,OAAO;uBAAMH,KAAK,CAACK,GAAG,CAACF,UAAU,CAAC;aAAA,CAAC;QACrC,CAAC,EAAE,EAAE,CAAC,CAAC;IACT,CAAC,AAAC;IAEF,OAAOG,MAAM,CAACC,MAAM,CAACP,KAAK,EAAE;QAC1BC,QAAQ,EAARA,QAAQ;KACT,CAAC,CAAC;AACL,CAAC;AAED;;GAEG,GACH,SAASJ,WAAW,GAA+C;IACjE,OAAOE,OAAO,CAAWD,MAAM,EAAY,CAAC,CAAC;AAC/C,CAAC;AAEDD,WAAW,CAACE,OAAO,GAAGA,OAAO,CAAC;AAE9B,SAASF,WAAW,GAAG"}