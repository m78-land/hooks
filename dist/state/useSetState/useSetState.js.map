{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/state/useSetState/useSetState.ts"],"sourcesContent":["import { useState, useCallback, useRef } from \"react\";\nimport { SetState, StateInitState } from \"@m78/hooks\";\nimport { AnyObject } from \"@m78/utils\";\n\n/**\n * 实现类似react类组件的setState Api\n * @param initState - 初始状态\n * @return tuple\n * @return tuple[0] - 当前状态\n * @return tuple[1] - 类似类组件的setState，不支持回调\n * */\nexport const useSetState = <T extends AnyObject>(\n  initState = {} as StateInitState<T>\n): [T, SetState<T>] => {\n  const [state, set] = useState<T>(initState);\n  const ref = useRef(state);\n\n  const setState = useCallback(\n    (patch: any) => {\n      const newState = {\n        ...state,\n        ...(patch instanceof Function ? patch(ref.current) : patch),\n      };\n      ref.current = Object.assign(ref.current, newState);\n      set(newState);\n    },\n    [set]\n  );\n\n  return [ref.current, setState];\n};\n"],"names":["useState","useCallback","useRef","useSetState","initState","state","set","ref","setState","patch","newState","Function","current","Object","assign"],"mappings":"AAAA;;AAAA,SAASA,QAAQ,EAAEC,WAAW,EAAEC,MAAM,QAAQ,OAAO,CAAC;AAItD;;;;;;GAMG,GACH,OAAO,IAAMC,WAAW,GAAG,WAEJ;QADrBC,SAAS,oEAAG,EAAE;IAEd,IAAqBJ,GAAsB,oBAAtBA,QAAQ,CAAII,SAAS,CAAC,IAAA,EAApCC,KAAK,GAASL,GAAsB,GAA/B,EAAEM,GAAG,GAAIN,GAAsB,GAA1B,AAA2B;IAC5C,IAAMO,IAAG,GAAGL,MAAM,CAACG,KAAK,CAAC,AAAC;IAE1B,IAAMG,QAAQ,GAAGP,WAAW,CAC1B,SAACQ,KAAU,EAAK;QACd,IAAMC,QAAQ,GAAG,mBACZL,KAAK,EACJI,KAAK,YAAYE,QAAQ,GAAGF,KAAK,CAACF,IAAG,CAACK,OAAO,CAAC,GAAGH,KAAK,CAC3D,AAAC;QACFF,IAAG,CAACK,OAAO,GAAGC,MAAM,CAACC,MAAM,CAACP,IAAG,CAACK,OAAO,EAAEF,QAAQ,CAAC,CAAC;QACnDJ,GAAG,CAACI,QAAQ,CAAC,CAAC;IAChB,CAAC,EACD;QAACJ,GAAG;KAAC,CACN,AAAC;IAEF,OAAO;QAACC,IAAG,CAACK,OAAO;QAAEJ,QAAQ;KAAC,CAAC;AACjC,CAAC,CAAC"}