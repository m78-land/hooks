{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/state/useMountState/useMountState.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useFn } from \"@m78/hooks\";\n\nexport interface UseMountStateConfig {\n  /** true | 如果为true，在第一次启用时才真正挂载内容 */\n  mountOnEnter?: boolean;\n  /** false | 在关闭时卸载内容 */\n  unmountOnExit?: boolean;\n}\n\n/**\n * 用于便捷的实现mountOnEnter/unmountOnExit接口\n * - 卸载的准确时机hook内是不能感知的，因为可能中间会存在动画或其他延迟行为，所以需要用户在正确时机调用unmount()通知卸载\n * */\nexport function useMountState(\n  toggle: boolean,\n  { mountOnEnter = true, unmountOnExit = false }: UseMountStateConfig = {}\n) {\n  const [mount, setMount] = useState(() => {\n    // mountOnEnter为false时，强制渲染, 否则取init\n    if (!mountOnEnter) return true;\n    return toggle;\n  });\n\n  // 自动同步true状态, false状态因为可能存在动画等, 由用户手动触发\n  useEffect(() => {\n    toggle && monkeySet(toggle);\n  }, [toggle]);\n\n  const unmount = useFn(() => monkeySet(false));\n\n  function monkeySet(m: boolean) {\n    // 需要挂载但未挂载时对其进行挂载\n    if (m && !mount) {\n      setMount(true);\n      return;\n    }\n\n    // 需要离场卸载且收到卸载通知且当前已挂载\n    if (unmountOnExit && !m && mount) {\n      setMount(false);\n    }\n  }\n\n  return [mount, unmount] as const;\n}\n"],"names":["useEffect","useState","useFn","useMountState","toggle","mountOnEnter","unmountOnExit","monkeySet","m","mount","setMount","unmount"],"mappings":"AAAA;AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO,CAAC;AAC5C,SAASC,KAAK,QAAQ,YAAY,CAAC;AASnC;;;GAGG,GACH,OAAO,SAASC,aAAa,CAC3BC,MAAe,EAEf;QADA,GAAwE,GAAxE,+CAAwE,kBAAF,EAAE,kBAAxE,GAAwE,CAAtEC,YAAY,EAAZA,YAAY,8BAAG,IAAI,gBAAA,mBAArB,GAAwE,CAAjDC,aAAa,EAAbA,aAAa,+BAAG,KAAK,iBAAA;QAenCC,SAAS,GAAlB,SAASA,SAAS,CAACC,CAAU,EAAE;QAC7B,kBAAkB;QAClB,IAAIA,CAAC,IAAI,CAACC,KAAK,EAAE;YACfC,QAAQ,CAAC,IAAI,CAAC,CAAC;YACf,OAAO;QACT,CAAC;QAED,sBAAsB;QACtB,IAAIJ,aAAa,IAAI,CAACE,CAAC,IAAIC,KAAK,EAAE;YAChCC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAClB,CAAC;IACH,CAAC;IAxBD,IAA0BT,IAIxB,oBAJwBA,QAAQ,CAAC,WAAM;QACvC,oCAAoC;QACpC,IAAI,CAACI,YAAY,EAAE,OAAO,IAAI,CAAC;QAC/B,OAAOD,MAAM,CAAC;IAChB,CAAC,CAAC,IAAA,EAJKK,KAAK,GAAcR,IAIxB,GAJU,EAAES,QAAQ,GAAIT,IAIxB,GAJoB,AAInB;IAEH,wCAAwC;IACxCD,SAAS,CAAC,WAAM;QACdI,MAAM,IAAIG,SAAS,CAACH,MAAM,CAAC,CAAC;IAC9B,CAAC,EAAE;QAACA,MAAM;KAAC,CAAC,CAAC;IAEb,IAAMO,OAAO,GAAGT,KAAK,CAAC;eAAMK,SAAS,CAAC,KAAK,CAAC;KAAA,CAAC,AAAC;IAe9C,OAAO;QAACE,KAAK;QAAEE,OAAO;KAAC,CAAU;AACnC,CAAC"}