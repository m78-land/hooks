{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/ui/useScroll/useScroll.ts"],"sourcesContent":["import { RefObject, useEffect, useRef } from \"react\";\n\nimport { isNumber, isDom } from \"@m78/utils\";\nimport _clamp from \"lodash/clamp\";\nimport { getRefDomOrDom, useSelf, useThrottle } from \"@m78/hooks\";\nimport { useSpring, config } from \"react-spring\";\n\ninterface UseScrollOptions {\n  /** 指定滚动元素或ref，el、el.current、ref.current取值，只要有任意一个为dom元素则返回, 默认的滚动元素是documentElement */\n  el?: HTMLElement | RefObject<any>;\n  /** 滚动时触发 */\n  onScroll?(meta: UseScrollMeta): void;\n  /** 100 | 配置了onScroll时，设置throttle时间, 单位(ms) */\n  throttleTime?: number;\n  /** 0 | 滚动偏移值, 使用scrollToElement时，会根据此值进行修正 */\n  offset?: number;\n  /** y轴的偏移距离，优先级高于offset */\n  offsetX?: number;\n  /** x轴的偏移距离，优先级高于offset */\n  offsetY?: number;\n  /** 0 | touch系列属性的触发修正值 */\n  touchOffset?: number;\n}\n\nexport interface UseScrollSetArg {\n  /** 指定滚动的x轴 */\n  x?: number;\n  /** 指定滚动的y轴 */\n  y?: number;\n  /** 以当前滚动位置为基础进行增减滚动 */\n  raise?: boolean;\n  /** 为true时阻止动画 */\n  immediate?: boolean;\n}\n\nexport interface UseScrollMeta {\n  /** 滚动元素 */\n  el: HTMLElement;\n  /** x轴位置 */\n  x: number;\n  /** y轴位置 */\n  y: number;\n  /** 可接受的x轴滚动最大值(值大于0说明可滚动， 但不能保证开启了滚动) */\n  xMax: number;\n  /** 可接受的y轴滚动最大值(值大于0说明可滚动， 但不能保证开启了滚动) */\n  yMax: number;\n  /** 元素高度 */\n  height: number;\n  /** 元素宽度 */\n  width: number;\n  /** 元素实际高度(包含边框/滚动条/内边距等) */\n  offsetWidth: number;\n  /** 元素实际宽度(包含边框/滚动条/内边距等) */\n  offsetHeight: number;\n  /** 元素总高度 */\n  scrollHeight: number;\n  /** 元素总宽度 */\n  scrollWidth: number;\n  /** 滚动条位于最底部 */\n  touchBottom: boolean;\n  /** 滚动条位于最右侧 */\n  touchRight: boolean;\n  /** 滚动条位于最顶部 */\n  touchTop: boolean;\n  /** 滚动条位于最左侧 */\n  touchLeft: boolean;\n}\n\ninterface UseScrollPosBase {\n  x?: number;\n  y?: number;\n}\n\nexport function useScroll<ElType extends HTMLElement>(\n  {\n    el,\n    onScroll,\n    throttleTime = 100,\n    offset = 0,\n    offsetX,\n    offsetY,\n    touchOffset = 0,\n  } = {} as UseScrollOptions\n) {\n  // 用于返回的节点获取ref\n  const ref = useRef<ElType>(null);\n\n  // 获取documentElement和body, 放到useEffect以兼容SSR\n  const self = useSelf({\n    docEl: null! as HTMLElement,\n    bodyEl: null! as HTMLElement,\n  });\n\n  const [spValue, spApi] = useSpring<{ y: number; x: number }>(() => ({\n    y: 0,\n    x: 0,\n    config: { clamp: true, ...config.stiff },\n  }));\n\n  /** 滚动处理 */\n  const scrollHandle = useThrottle(() => {\n    onScroll && onScroll(get());\n  }, throttleTime);\n\n  /** 初始化获取根节点 */\n  useEffect(() => {\n    self.docEl = document.documentElement;\n    self.bodyEl = document.body;\n  }, []);\n\n  /** 绑定滚动事件 */\n  useEffect(() => {\n    const sEl = getEl();\n\n    /* 坑: 页面级滚动scroll事件绑在documentElement和body上无效, 只能绑在window上 */\n    const scrollEl = elIsDoc(sEl) ? window : sEl;\n\n    scrollEl.addEventListener(\"scroll\", scrollHandle);\n\n    return () => {\n      scrollEl.removeEventListener(\"scroll\", scrollHandle);\n    };\n  }, [el, ref.current]);\n\n  /** 执行滚动、拖动操作时，停止当前正在进行的滚动操作 */\n  useEffect(() => {\n    const sEl = getEl();\n\n    function wheelHandle() {\n      if (spValue.x.isAnimating || spValue.y.isAnimating) {\n        // @ts-ignore\n        spApi.stop();\n      }\n    }\n\n    sEl.addEventListener(\"wheel\", wheelHandle);\n    sEl.addEventListener(\"touchmove\", wheelHandle);\n\n    return () => {\n      sEl.removeEventListener(\"wheel\", wheelHandle);\n      sEl.removeEventListener(\"touchmove\", wheelHandle);\n    };\n  }, [el, ref.current]);\n\n  /** 检测元素是否是body或html节点 */\n  function elIsDoc(_el?: HTMLElement) {\n    const sEl = _el || getEl();\n    return sEl === self.docEl || sEl === self.bodyEl;\n  }\n\n  /** 根据参数获取滚动元素，默认为文档元素 */\n  function getEl(): HTMLElement {\n    return getRefDomOrDom(el, ref) || self.docEl;\n  }\n\n  /** 动画滚动到指定位置 */\n  function animateTo(\n    sEl: HTMLElement,\n    next: UseScrollPosBase,\n    now: UseScrollPosBase\n  ) {\n    const isDoc = elIsDoc(sEl);\n\n    spApi({\n      ...next,\n      from: now,\n      onChange(result: any) {\n        const x = result.value.x;\n        const y = result.value.y;\n\n        if (isDoc) {\n          setDocPos(x, y);\n        } else {\n          sEl.scrollTop = y;\n          sEl.scrollLeft = x;\n        }\n      },\n    });\n  }\n\n  /** 根据传入的x、y值设置滚动位置 */\n  function set({ x, y, raise, immediate }: UseScrollSetArg) {\n    const scroller = getEl();\n\n    const { xMax, yMax, x: oldX, y: oldY } = get();\n\n    const nextPos: UseScrollPosBase = {};\n    const nowPos: UseScrollPosBase = {\n      x: oldX,\n      y: oldY,\n    };\n\n    if (isNumber(x)) {\n      let nextX = x;\n\n      if (raise) {\n        nextX = _clamp(oldX + x, 0, xMax);\n      }\n\n      if (nextX !== oldX) {\n        nextPos.x = nextX;\n      }\n    }\n\n    if (isNumber(y)) {\n      let nextY = y;\n\n      if (raise) {\n        nextY = _clamp(oldY + y, 0, yMax);\n      }\n\n      if (nextY !== oldY) {\n        nextPos.y = nextY;\n      }\n    }\n\n    if (\"x\" in nextPos || \"y\" in nextPos) {\n      const isDoc = elIsDoc(scroller);\n\n      if (immediate) {\n        if (isNumber(nextPos.x)) {\n          if (isDoc) {\n            setDocPos(nextPos.x);\n          } else {\n            scroller.scrollLeft = nextPos.x;\n          }\n        }\n        if (isNumber(nextPos.y)) {\n          if (isDoc) {\n            setDocPos(undefined, nextPos.y);\n          } else {\n            scroller.scrollTop = nextPos.y;\n          }\n        }\n      } else {\n        animateTo(scroller, nextPos, nowPos);\n      }\n    }\n  }\n\n  /**\n   * 传入选择器或者dom元素\n   * @param selector | target\n   *    selector - 滚动到以该选择器命中的第一个元素\n   *    element - 滚动到指定元素\n   * @param immediate - 是否跳过动画\n   * */\n  function scrollToElement(selector: string, immediate?: boolean): void;\n  function scrollToElement(element: HTMLElement, immediate?: boolean): void;\n  function scrollToElement(arg: string | HTMLElement, immediate?: boolean) {\n    const sEl = getEl();\n    const isDoc = elIsDoc(sEl);\n\n    let targetEl: HTMLElement | null;\n\n    if (!sEl.getBoundingClientRect) {\n      console.warn(\"The browser does not support `getBoundingClientRect` API\");\n      return;\n    }\n\n    if (typeof arg === \"string\") {\n      targetEl = getEl().querySelector(arg);\n    } else {\n      targetEl = arg;\n    }\n\n    if (!isDom(targetEl)) return;\n\n    const { top: cTop, left: cLeft } = targetEl.getBoundingClientRect();\n    const { top: fTop, left: fLeft } = sEl.getBoundingClientRect();\n\n    /**\n     * 使用offsetTop等属性只能获取到元素相对于第一个非常规定位父元素的距离，所以需要单独计算\n     * 计算规则: eg. 子元素距离顶部比父元素多100px，滚动条位置应该减少100px让两者等值\n     * */\n    const xOffset = offsetX || offset;\n    const yOffset = offsetY || offset;\n\n    set({\n      x: cLeft - fLeft + xOffset,\n      y: cTop - fTop + yOffset,\n      raise: !isDoc, // 如果滚动节点为html元素, 可以直接取计算结果\n      immediate,\n    });\n  }\n\n  /** 获取各种有用的滚动信息 */\n  function get(): UseScrollMeta {\n    const isDoc = elIsDoc();\n\n    const sEl = getEl();\n\n    let x = isDoc\n      ? self.docEl.scrollLeft + self.bodyEl.scrollLeft\n      : sEl.scrollLeft;\n    let y = isDoc\n      ? self.docEl.scrollTop + self.bodyEl.scrollTop\n      : sEl.scrollTop;\n\n    /* chrome高分屏+缩放时，滚动值会是小数，想上取整防止计算错误 */\n    x = Math.ceil(x);\n    y = Math.ceil(y);\n\n    const height = sEl.clientHeight;\n    const width = sEl.clientWidth;\n    const { scrollHeight } = sEl;\n    const { scrollWidth } = sEl;\n\n    /* chrome下(高分屏+缩放),无滚动的情况下scrollWidth会大于width */\n    const xMax = Math.max(0, scrollWidth - width);\n    const yMax = Math.max(0, scrollHeight - height);\n\n    return {\n      el: sEl,\n      x,\n      y,\n      xMax,\n      yMax,\n      height,\n      width,\n      scrollHeight,\n      scrollWidth,\n      touchBottom: yMax - y - touchOffset <= 0,\n      touchLeft: x <= touchOffset,\n      touchRight: xMax - x - touchOffset <= 0, // 总宽度 - 宽度 = 滚动条实际宽度\n      touchTop: y <= touchOffset,\n      offsetWidth: sEl.offsetWidth,\n      offsetHeight: sEl.offsetHeight,\n    };\n  }\n\n  /** 设置根级的滚动位置 */\n  function setDocPos(x?: number, y?: number) {\n    if (isNumber(x)) {\n      // 只有一个会生效\n      self.bodyEl.scrollLeft = x;\n      self.docEl.scrollLeft = x;\n    }\n\n    if (isNumber(y)) {\n      self.bodyEl.scrollTop = y;\n      self.docEl.scrollTop = y;\n    }\n  }\n\n  return {\n    set,\n    get,\n    scrollToElement,\n    ref,\n  };\n}\n"],"names":["useScroll","el","onScroll","throttleTime","offset","offsetX","offsetY","touchOffset","elIsDoc","_el","sEl","getEl","self","docEl","bodyEl","getRefDomOrDom","ref","animateTo","next","now","isDoc","spApi","from","onChange","result","x","value","y","setDocPos","scrollTop","scrollLeft","set","raise","immediate","scroller","get","xMax","yMax","oldX","oldY","nextPos","nowPos","isNumber","nextX","_clamp","nextY","undefined","scrollToElement","arg","targetEl","getBoundingClientRect","console","warn","querySelector","isDom","top","cTop","left","cLeft","fTop","fLeft","xOffset","yOffset","Math","ceil","height","clientHeight","width","clientWidth","scrollHeight","scrollWidth","max","touchBottom","touchLeft","touchRight","touchTop","offsetWidth","offsetHeight","useRef","useSelf","useSpring","config","clamp","stiff","spValue","scrollHandle","useThrottle","useEffect","document","documentElement","body","scrollEl","window","addEventListener","removeEventListener","current","wheelHandle","isAnimating","stop"],"mappings":"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"}