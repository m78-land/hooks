{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/state/useMountState/useMountState.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useFn } from \"@m78/hooks\";\n\nexport interface UseMountStateConfig {\n  /** true | 如果为true，在第一次启用时才真正挂载内容 */\n  mountOnEnter?: boolean;\n  /** false | 在关闭时卸载内容 */\n  unmountOnExit?: boolean;\n}\n\n/**\n * 用于便捷的实现mountOnEnter/unmountOnExit接口\n * - 卸载的准确时机hook内是不能感知的，因为可能中间会存在动画或其他延迟行为，所以需要用户在正确时机调用unmount()通知卸载\n * */\nexport function useMountState(\n  toggle: boolean,\n  { mountOnEnter = true, unmountOnExit = false }: UseMountStateConfig = {}\n) {\n  const [mount, setMount] = useState(() => {\n    // mountOnEnter为false时，强制渲染, 否则取init\n    if (!mountOnEnter) return true;\n    return toggle;\n  });\n\n  // 自动同步true状态, false状态因为可能存在动画等, 由用户手动触发\n  useEffect(() => {\n    toggle && monkeySet(toggle);\n  }, [toggle]);\n\n  const unmount = useFn(() => monkeySet(false));\n\n  function monkeySet(m: boolean) {\n    // 需要挂载但未挂载时对其进行挂载\n    if (m && !mount) {\n      setMount(true);\n      return;\n    }\n\n    // 需要离场卸载且收到卸载通知且当前已挂载\n    if (unmountOnExit && !m && mount) {\n      setMount(false);\n    }\n  }\n\n  return [mount, unmount] as const;\n}\n"],"names":["useMountState","toggle","mountOnEnter","unmountOnExit","monkeySet","m","mount","setMount","useState","useEffect","unmount","useFn"],"mappings":"AAAA;qJAAoC,OAAO,WACrB,YAAY;;;;QADE,OAAO;QACrB,YAAY;;;;;;;;mCAalBA,eAAa;;;mBAAbA,aAAa;;;;IAAtB,SAASA,aAAa,CAC3BC,MAAe,EAEf;YADA,GAAwE,GAAxE,+CAAwE,kBAAF,EAAE,kBAAxE,GAAwE,CAAtEC,YAAY,EAAZA,YAAY,8BAAG,IAAI,gBAAA,mBAArB,GAAwE,CAAjDC,aAAa,EAAbA,aAAa,+BAAG,KAAK,iBAAA;YAenCC,SAAS,GAAlB,SAASA,SAAS,CAACC,CAAU,EAAE;YAC7B,kBAAkB;YAClB,IAAIA,CAAC,IAAI,CAACC,KAAK,EAAE;gBACfC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,OAAO;YACT,CAAC;YAED,sBAAsB;YACtB,IAAIJ,aAAa,IAAI,CAACE,CAAC,IAAIC,KAAK,EAAE;gBAChCC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAClB,CAAC;QACH,CAAC;QAxBD,IAA0BC,IAIxB,kBAJwBA,IAAAA,MAAQ,SAAA,EAAC,WAAM;YACvC,oCAAoC;YACpC,IAAI,CAACN,YAAY,EAAE,OAAO,IAAI,CAAC;YAC/B,OAAOD,MAAM,CAAC;QAChB,CAAC,CAAC,IAAA,EAJKK,KAAK,GAAcE,IAIxB,GAJU,EAAED,QAAQ,GAAIC,IAIxB,GAJoB,AAInB;QAEH,wCAAwC;QACxCC,IAAAA,MAAS,UAAA,EAAC,WAAM;YACdR,MAAM,IAAIG,SAAS,CAACH,MAAM,CAAC,CAAC;QAC9B,CAAC,EAAE;YAACA,MAAM;SAAC,CAAC,CAAC;QAEb,IAAMS,OAAO,GAAGC,IAAAA,MAAK,MAAA,EAAC;mBAAMP,SAAS,CAAC,KAAK,CAAC;SAAA,CAAC,AAAC;QAe9C,OAAO;YAACE,KAAK;YAAEI,OAAO;SAAC,CAAU;IACnC,CAAC"}