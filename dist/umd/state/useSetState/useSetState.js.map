{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/state/useSetState/useSetState.ts"],"sourcesContent":["import { useState, useCallback, useRef } from \"react\";\nimport { SetState, StateInitState } from \"@m78/hooks\";\nimport { AnyObject } from \"@m78/utils\";\n\n/**\n * 实现类似react类组件的setState Api\n * @param initState - 初始状态\n * @return tuple\n * @return tuple[0] - 当前状态\n * @return tuple[1] - 类似类组件的setState，不支持回调\n * */\nexport const useSetState = <T extends AnyObject>(\n  initState = {} as StateInitState<T>\n): [T, SetState<T>] => {\n  const [state, set] = useState<T>(initState);\n  const ref = useRef(state);\n\n  const setState = useCallback(\n    (patch: any) => {\n      const newState = {\n        ...state,\n        ...(patch instanceof Function ? patch(ref.current) : patch),\n      };\n      ref.current = Object.assign(ref.current, newState);\n      set(newState);\n    },\n    [set]\n  );\n\n  return [ref.current, setState];\n};\n"],"names":["useSetState","initState","useState","state","set","ref","useRef","setState","useCallback","patch","newState","Function","current","Object","assign"],"mappings":"AAAA;qMAA8C,OAAO;;;;;QAAP,OAAO;;;;;;;;mCAWxCA,aAAW;;;mBAAXA,WAAW;;;;;IAAjB,IAAMA,WAAW,GAAG,WAEJ;YADrBC,SAAS,oEAAG,EAAE;QAEd,IAAqBC,GAAsB,kBAAtBA,IAAAA,MAAQ,SAAA,EAAID,SAAS,CAAC,IAAA,EAApCE,KAAK,GAASD,GAAsB,GAA/B,EAAEE,GAAG,GAAIF,GAAsB,GAA1B,AAA2B;QAC5C,IAAMG,IAAG,GAAGC,IAAAA,MAAM,OAAA,EAACH,KAAK,CAAC,AAAC;QAE1B,IAAMI,QAAQ,GAAGC,IAAAA,MAAW,YAAA,EAC1B,SAACC,KAAU,EAAK;YACd,IAAMC,QAAQ,GAAG,kBACZP,KAAK,EACJM,KAAK,YAAYE,QAAQ,GAAGF,KAAK,CAACJ,IAAG,CAACO,OAAO,CAAC,GAAGH,KAAK,CAC3D,AAAC;YACFJ,IAAG,CAACO,OAAO,GAAGC,MAAM,CAACC,MAAM,CAACT,IAAG,CAACO,OAAO,EAAEF,QAAQ,CAAC,CAAC;YACnDN,GAAG,CAACM,QAAQ,CAAC,CAAC;QAChB,CAAC,EACD;YAACN,GAAG;SAAC,CACN,AAAC;QAEF,OAAO;YAACC,IAAG,CAACO,OAAO;YAAEL,QAAQ;SAAC,CAAC;IACjC,CAAC,AAAC"}