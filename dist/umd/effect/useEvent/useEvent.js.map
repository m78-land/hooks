{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/effect/useEvent/useEvent.ts"],"sourcesContent":["import { useFn } from \"@m78/hooks\";\nimport { useEffect } from \"react\";\nimport { AnyFunction, CustomEvent, createEvent as create } from \"@m78/utils\";\n\nexport interface CustomEventWithHook<Listener extends AnyFunction>\n  extends CustomEvent<Listener> {\n  useEvent(listener: Listener): void;\n}\n\n/** 增强一个现有事件对象 */\nexport function enhance<Listener extends AnyFunction = AnyFunction>(\n  event: CustomEvent<Listener>\n): CustomEventWithHook<Listener> {\n  const useEvent = (listener: Listener) => {\n    const memoHandle = useFn(listener);\n\n    useEffect(() => {\n      event.on(memoHandle);\n\n      return () => event.off(memoHandle);\n    }, []);\n  };\n\n  return Object.assign(event, {\n    useEvent,\n  });\n}\n\n/**\n * 自定义事件，用于多个组件间或组件外进行通讯\n * */\nfunction createEvent<Listener extends AnyFunction = AnyFunction>() {\n  return enhance<Listener>(create<Listener>());\n}\n\ncreateEvent.enhance = enhance;\n\nexport { createEvent };\n"],"names":["enhance","createEvent","event","useEvent","listener","memoHandle","useFn","useEffect","on","off","Object","assign","create"],"mappings":"AAAA;mGAAsB,YAAY,WACR,OAAO,WAC+B,YAAY;;;QAFtD,YAAY;QACR,OAAO;QAC+B,YAAY;;;;;;;;;;;;;;;QAQ5DA,OAAO;mBAAPA,OAAO;;QA2BdC,WAAW;mBAAXA,WAAW;;;IA3Bb,SAASD,OAAO,CACrBE,KAA4B,EACG;QAC/B,IAAMC,QAAQ,GAAG,SAACC,QAAkB,EAAK;YACvC,IAAMC,UAAU,GAAGC,IAAAA,MAAK,MAAA,EAACF,QAAQ,CAAC,AAAC;YAEnCG,IAAAA,MAAS,UAAA,EAAC,WAAM;gBACdL,KAAK,CAACM,EAAE,CAACH,UAAU,CAAC,CAAC;gBAErB,OAAO;2BAAMH,KAAK,CAACO,GAAG,CAACJ,UAAU,CAAC;iBAAA,CAAC;YACrC,CAAC,EAAE,EAAE,CAAC,CAAC;QACT,CAAC,AAAC;QAEF,OAAOK,MAAM,CAACC,MAAM,CAACT,KAAK,EAAE;YAC1BC,QAAQ,EAARA,QAAQ;SACT,CAAC,CAAC;IACL,CAAC;IAED;;GAEG,GACH,SAASF,WAAW,GAA+C;QACjE,OAAOD,OAAO,CAAWY,IAAAA,MAAM,YAAA,GAAY,CAAC,CAAC;IAC/C,CAAC;IAEDX,WAAW,CAACD,OAAO,GAAGA,OAAO,CAAC"}