{"version":3,"sources":["/Users/lixianjie/project/openSource/hooks/src/effect/useDebounce/useDebounce.ts"],"sourcesContent":["import { useEffect } from \"react\";\nimport { AnyFunction, __GLOBAL__ } from \"@m78/utils\";\nimport { useSelf, useFn } from \"@m78/hooks\";\n\n/**\n * 传入一个函数，经过防抖处理后返回, 返回函数的内存地址会一直保持不变\n * @param fn - 待防抖的函数\n * @param wait - 防抖延迟时间\n * @returns debounceFn - 经过防抖处理后的函数\n * @returns debounceFn.cancel() - 取消防抖调用\n */\nexport function useDebounce<T extends AnyFunction>(fn: T, wait = 300) {\n  const self = useSelf({\n    timer: undefined as any,\n  });\n\n  const cancel = useFn(() => {\n    if (self.timer) {\n      __GLOBAL__.clearTimeout(self.timer);\n    }\n  });\n\n  useEffect(() => {\n    return cancel;\n  });\n\n  const memoFn = useFn((...args) => {\n    cancel();\n\n    self.timer = __GLOBAL__.setTimeout(() => {\n      fn(...args);\n      __GLOBAL__.clearTimeout(self.timer);\n    }, wait);\n  });\n\n  const bundle = Object.assign(memoFn as T, {\n    cancel,\n  });\n\n  return bundle;\n}\n"],"names":["useDebounce","fn","wait","self","useSelf","timer","undefined","cancel","useFn","__GLOBAL__","clearTimeout","useEffect","memoFn","args","setTimeout","bundle","Object","assign"],"mappings":"AAAA;yJAA0B,OAAO,WACO,YAAY,WACrB,YAAY;;;;QAFjB,OAAO;QACO,YAAY;QACrB,YAAY;;;;;;;;mCAS3BA,aAAW;;;mBAAXA,WAAW;;;;IAApB,SAASA,WAAW,CAAwBC,EAAK,EAAc;YAAZC,IAAI,GAAJA,+CAAU,kBAAH,GAAG;QAClE,IAAMC,KAAI,GAAGC,IAAAA,MAAO,QAAA,EAAC;YACnBC,KAAK,EAAEC,SAAS;SACjB,CAAC,AAAC;QAEH,IAAMC,MAAM,GAAGC,IAAAA,MAAK,MAAA,EAAC,WAAM;YACzB,IAAIL,KAAI,CAACE,KAAK,EAAE;gBACdI,MAAU,cAAA,CAACC,YAAY,CAACP,KAAI,CAACE,KAAK,CAAC,CAAC;YACtC,CAAC;QACH,CAAC,CAAC,AAAC;QAEHM,IAAAA,MAAS,UAAA,EAAC,WAAM;YACd,OAAOJ,MAAM,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,IAAMK,MAAM,GAAGJ,IAAAA,MAAK,MAAA,EAAC,WAAa;6CAATK,IAAI;gBAAJA,IAAI;;YAC3BN,MAAM,EAAE,CAAC;YAETJ,KAAI,CAACE,KAAK,GAAGI,MAAU,cAAA,CAACK,UAAU,CAAC,WAAM;gBACvCb,EAAE,CAAFA,KAAW,CAAXA,KAAAA,CAAE,EAAC,mBAAGY,IAAI,CAAJA,CAAK,CAAC;gBACZJ,MAAU,cAAA,CAACC,YAAY,CAACP,KAAI,CAACE,KAAK,CAAC,CAAC;YACtC,CAAC,EAAEH,IAAI,CAAC,CAAC;QACX,CAAC,CAAC,AAAC;QAEH,IAAMa,MAAM,GAAGC,MAAM,CAACC,MAAM,CAACL,MAAM,EAAO;YACxCL,MAAM,EAANA,MAAM;SACP,CAAC,AAAC;QAEH,OAAOQ,MAAM,CAAC;IAChB,CAAC"}